@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layoutview.cshtml";

    var user = ViewBag.UserId;
    var userType = ViewBag.UserType;

    var UserPassword = ViewBag.UserPassword;
    var id = ViewBag.id;
    var Name = ViewBag.Name;
    var LastNameuser = ViewBag.LastName;
    var Address01 = ViewBag.Address01;
    var Address02 = ViewBag.Address02;
    var Province = ViewBag.Province;
    var Postcode = ViewBag.Postcode;
    var EMail = ViewBag.EMail;
    var Tel = ViewBag.Tel;
    var LineID = ViewBag.LineID;
    var SubDistrict = ViewBag.SubDistrict;
    var District = ViewBag.District;

}

<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>E-Warranty Register</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Kanit">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">

    <script src="~/Scripts/jquery-validation-1.19.5/lib/jquery.js"></script>
    <script src="~/Scripts/jquery-validation-1.19.5/dist/jquery.validate.js"></script>
    <link href="~/bootstrap-select-1.13.14/dist/css/bootstrap-select.css" rel="stylesheet" />
    <script src="~/bootstrap-select-1.13.14/dist/js/bootstrap-select.js"></script>

    <script src="~/fixed-table-master/fixed-table.js"></script>
    <link href="~/fixed-table-master/fixed-table.css" rel="stylesheet" />

    <link href="~/Css/LoadingSpinner.css" rel="stylesheet" />
    <style>
        /* Style all input fields */
        input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 6px;
            margin-bottom: 16px;
        }

            /* Style the submit button */
            input[type=submit] {
                background-color: #04AA6D;
                color: white;
            }

        /* Style the container for inputs */
        .container {
            background-color: #f1f1f1;
            padding: 20px;
        }

        /* The message box is shown when the user clicks on the password field */
        /* The message box is shown when the user clicks on the password field */
        #message {
            display: none;
            background: #f1f1f1;
            color: #000;
            position: relative;
            padding: 20px;
            margin-top: 10px;
            margin: auto;
        }

            #message p {
                padding: 0px 19px;
                /*padding: 0px 186px;*/
                font-size: 0.875rem;
            }

        #message1 {
            display: none;
            background: #f1f1f1;
            color: #000;
            position: relative;
            padding: 20px;
            margin-top: 10px;
            margin: auto;
        }

            #message1 p {
                padding: 0px 19px;
                /*padding: 0px 186px;*/
                font-size: 0.875rem;
            }

        #messagecf {
            display: none;
            background: #f1f1f1;
            color: #000;
            position: relative;
            padding: 20px;
            margin-top: 10px;
            margin: auto;
        }

            #messagecf p {
                padding: 0px 19px;
                /*padding: 0px 186px;*/
                font-size: 0.875rem;
            }
        /* Add a green text color and a checkmark when the requirements are right */
        .valid {
            color: green;
        }

            .valid:before {
                position: relative;
                left: -35px;
                content: "✔";
            }

        /* Add a red text color and an "x" when the requirements are wrong */
        .invalid {
            color: red;
        }

            .invalid:before {
                position: relative;
                left: -35px;
                content: "✖";
            }

        .field-icon {
            float: right;
            margin-left: -41px;
            margin-top: 12px;
            position: relative;
            z-index: 2;
        }
    </style>
    <style>
        form.cmxform label.error, label.error {
            color: red;
            font-style: italic;
        }

        #commentForm {
            width: 500px;
        }

            #commentForm label {
                width: 250px;
            }

                #commentForm label.error, #commentForm input.submit {
                    margin-left: 253px;
                }



        #signupForm label.error {
            margin-left: 10px;
            width: auto;
            display: inline;
        }

        #newsletter_topics label.error {
            display: none;
            margin-left: 103px;
        }
    </style>
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o), m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-33058582-1', 'auto', {
            'name': 'Main'
        });
        ga('Main.send', 'event', 'jquery.Thailand.js', 'GitHub', 'Visit');
    </script>
</head>
<body>
    @*get password*@
    <input type="hidden" id="getPasswordOld" value="@UserPassword" />

    <div class="content-wrapper">

        <div class="row">
            <div class="col-lg-12 mx-auto">
                <h2 class="text-center mb-4">
                    แก้ไขข้อมูลส่วนตัว
                </h2>
                <div class="col-lg-12 mx-auto">
                    <div>
                        <div class="col-12 grid-margin">
                            <div class="card">
                                <div class="card-body" style="padding:12px;">
                                    <p class=""> กรุณากรอกข้อมูลของท่านตาม * ให้ครบถ้วน </p>
                                    <form class="cmxform" id="signupForm" method="get" action="">
                                        <fieldset>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group row">

                                                        <label class="col-sm-3 col-form-label">ชื่อ*</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" class="form-control" id="b_name" name="b_name" value="@Name" required />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">นามสกุล*</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" class="form-control" id="b_lastname" name="b_lastname" value="@LastNameuser" required />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">ที่อยู่ 1 *</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" class="form-control" id="address1" name="address1" value="@Address01" required />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">ที่อยู่ 2</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" class="form-control" id="address2" name="address2" value="@Address02" />
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">แขวง/ตำบล *</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" class="form-control" id="district" name="district" value="@SubDistrict" required />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">เขต/อำเภอ *</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" class="form-control" id="amphoe" name="amphoe" value="@District" required />
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="row">

                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">จังหวัด *</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" class="form-control" id="province" name="province" value="@Province" required />
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">รหัสไปรษณีย์ *</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" class="form-control" id="zipcode" name="zipcode" value="@Postcode" required />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">

                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">เบอร์โทรศัพท์(เฉพาะตัวเลข)*</label>
                                                        <div class="col-sm-9">
                                                            <input type="number" class="form-control" id="b_tel" name="b_tel" value="@Tel" required />
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">ไลน์ไอดี</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" class="form-control" id="b_lineid" name="b_lineid" value="@LineID" />
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">อีเมล *</label>
                                                        <div class="col-sm-9">
                                                            <input type="email" class="form-control" id="email" name="email" value="@EMail" />
                                                        </div>

                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row" style="margin-top: -15px;">
                                                <div class="col-md-12">
                                                    <hr>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">รหัสผ่านปัจจุบัน</label>
                                                        <div class="col-sm-9">
                                                            <input class="form-control" placeholder="รหัสผ่านปัจจุบัน" maxlength="8" id="password" type="text" name="password">
                                                        </div>
                                                        @*<span toggle="#password" class="fa fa-fw fa-eye field-icon toggle-password"></span>*@
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">รหัสผ่านใหม่</label>
                                                        <div class="col-sm-9">
                                                            <input class="form-control" type="text" maxlength="8" placeholder="รหัสผ่านใหม่" id="confirm_password" name="confirm_password">
                                                        </div>
                                                        @*<span toggle="#confirm_password" class="fa fa-fw fa-eye field-icon toggle-cfpassword"></span>*@
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                </div>
                                                <div class="col-md-6">
                                                    <div id="message">
                                                        <p>รหัสผ่านจะต้องประกอบด้วย:</p>
                                                        <p id="letter" class="invalid"><b>ภาษาอังกฤษตัวพิมพ์เล็ก</b></p>
                                                        <p id="capital" class="invalid"><b>ภาษาอังกฤษตัวพิมพ์ใหญ่</b></p>
                                                        <p id="number" class="invalid"><b>ตัวเลข</b></p>
                                                        <p id="length" class="invalid"><b>ตัวอักษรมีความยาว 8 ตัวอักษร</b></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">ยืนยันรหัสผ่านใหม่</label>
                                                        <div class="col-sm-9">
                                                            <input class="form-control" type="text" maxlength="8" placeholder="ยืนยันรหัสผ่านใหม่" id="confirm_password1" name="confirm_password1">
                                                        </div>
                                                        @*<span toggle="#confirm_password1" class="fa fa-fw fa-eye field-icon toggle-cfpassword1"></span>*@
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6">


                                                </div>
                                                <div class="col-md-6">
                                                    <div id="message1">
                                                        <p>รหัสผ่านจะต้องประกอบด้วย:</p>
                                                        <p id="letter1" class="invalid"><b>ภาษาอังกฤษตัวพิมพ์เล็ก</b></p>
                                                        <p id="capital1" class="invalid"><b>ภาษาอังกฤษตัวพิมพ์ใหญ่</b></p>
                                                        <p id="number1" class="invalid"><b>ตัวเลข</b></p>
                                                        <p id="length1" class="invalid"><b>ตัวอักษรมีความยาว 8 ตัวอักษร</b></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                </div>
                                                <div class="col-md-6">
                                                    <span id="messagex" style="color:red"> </span> <br><br>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 mx-auto text-center">
                                                <div class="form-group">
                                                    @*<button class="btn btn-primary submit-btn btn-block" id="b-cf-reg">ลงทะเบียน</button>*@
                                                    <input class="submit" type="submit" value="ยืนยันแก้ไขข้อมูล" style="max-width: 260px;">
                                                </div>
                                            </div>
                                        </fieldset>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- content-wrapper ends -->
    </div>
    <!-- page-body-wrapper ends -->
    </div>
    <div id="overlay">
        <div class="cv-spinner">
            <span class="spinner"></span>
        </div>
    </div>
    <div class="modal" id="myModal" style="background-color: black;">

        <div class="modal-dialog" role="document" style="width: 360px;">

            <div class="modal-content">

                <div class="modal-header" style="background-color: #337AB7; padding: 16px 16px; color: #FFF; border-bottom: 2px dashed #337AB7; ">

                    @*<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>*@

                    <h4 class="modal-title" id="myModalLabel"></h4>

                </div>

                <div class="modal-body" id="texterror">
                </div>

                <div class="modal-footer">

                    @*<button type="button" class="btn btn btn-primary" data-dismiss="modal">OK</button>*@

                    <button type="button" class="btn btn btn-success" data-dismiss="modal" id="btnlogin">เข้าสู่ระบบอีกครั้ง</button>

                    @*<button type="button" class="btn btn-orange" data-dismiss="modal">Cancel</button>*@

                </div>

            </div>

        </div>

    </div>
    <!-- Modal -->
    <div class="modal" id="Modalsave" style="background-color: black;">
        @*<div class="modal fade" id="Modalsave" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">*@

        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">เปลี่ยนรหัสผ่านสำเร็จ</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    เปลี่ยนรหัสผ่านสำเร็จ ระบบส่ง รหัสผ่านใหม่เข้าอีเมล ที่ท่านลงทะเบียนไว้เรียบร้อยแล้ว กลับหน้าจอ เข้าสู่ระบบ
                </div>
                <div class="modal-footer">

                    <button type="button" class="btn btn-success" onclick="urllogin()">ตกลง</button>
                    @*<button type="button" class="btn btn-secondary" data-dismiss="modal">ไม่ใช่</button>*@

                </div>
            </div>
        </div>
    </div>

    <button type="button" class="btn btn-primary" id="hiddenclick" data-toggle="modal" data-target="#Modalsave" hidden>
        ตกลง
    </button>
    <div id="overlay">
        <div class="cv-spinner">
            <span class="spinner"></span>
        </div>
    </div>
    <script type="text/javascript" src="https://earthchie.github.io/jquery.Thailand.js/jquery.Thailand.js/dependencies/JQL.min.js"></script>
    <script type="text/javascript" src="https://earthchie.github.io/jquery.Thailand.js/jquery.Thailand.js/dependencies/typeahead.bundle.js"></script>
    <link rel="stylesheet" href="https://earthchie.github.io/jquery.Thailand.js/jquery.Thailand.js/dist/jquery.Thailand.min.css">
    <script type="text/javascript" src="https://earthchie.github.io/jquery.Thailand.js/jquery.Thailand.js/dist/jquery.Thailand.min.js"></script>

    <!-- container-scroller -->
    <!-- plugins:js -->
    @*<script src="~/BootstrapTemplate/src/assets/vendors/js/vendor.bundle.base.js"></script>
        <script src="~/BootstrapTemplate/src/assets/vendors/js/vendor.bundle.addons.js"></script>*@
    <!-- endinject -->
    <!-- inject:js -->
    <script src="~/BootstrapTemplate/src/assets/js/shared/off-canvas.js"></script>
    <script src="~/BootstrapTemplate/src/assets/js/shared/misc.js"></script>
    <!-- endinject -->
    <script src="~/BootstrapTemplate/src/assets/js/shared/jquery.cookie.js" type="text/javascript"></script>

    <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" integrity="sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ==" crossorigin="anonymous"></script>
    <script src="~/Scripts/localhost.js"></script>

    <script type="text/javascript">
            $('#regid').css("color", "#212529");
            $('#regeditid').css("color", "blue");
            $('#changeid').css("color", "#212529");
            $('#Inquiryid').css("color", "#212529");



            $.Thailand({
                $district: $('#district'), // input ของตำบล
                $amphoe: $('#amphoe'), // input ของอำเภอ
                $province: $('#province'), // input ของจังหวัด
                $zipcode: $('#zipcode'), // input ของรหัสไปรษณีย์
            });

            //   $("#myModal").modal();
            var id = '@Request.RequestContext.HttpContext.Session["ID"]';
            var userid = '@Request.RequestContext.HttpContext.Session["UserID"]';
            var usertype = '@Request.RequestContext.HttpContext.Session["UserType"]';
            // let lastname = sessionStorage.getItem("hostname");
            let lastname = getlocalhost();
            console.log(lastname);
            function checklogin(userid, id) {
                $.ajax({
                    url: '@Url.Action("GetdataSessionlogin", "GetdataCenter")',
                    data: {
                        UsrID: userid,
                        SessionId: id

                    },
                    type: "POST",
                    dataType: "JSON",
                    success: function (data) {
                        var splitstring = data.StrStstuslogin;
                        //console.log(splitstring);
                        let text = splitstring;
                        const myArray = text.split("|");
                        let mysession = myArray[1];
                        let mystatus = myArray[0];
                        // console.log("mystatus " + mystatus + "//////" + "mysession " + mysession);
                        if (id != mysession) {
                            $("#texterror").empty();
                            $("#texterror").text("ขออภัย ท่านทำรายการเกินระยะเวลาที่กำหนด กรุณาเข้าใช้งานใหม่อีกครั้ง");
                            //  $("#btn_click").trigger("click");
                            $("#myModal").modal();
                            //  $('#myModal').modal({ backdrop: 'static', keyboard: false }, 'show');
                            //$("#myModal").modal();
                            return false;
                            //window.location.replace("../Account/LogIn");
                        } else {

                            if (mystatus == "0") {
                                $("#texterror").empty();
                                $("#texterror").text("ขออภัย ท่านทำรายการเกินระยะเวลาที่กำหนด กรุณาเข้าใช้งานใหม่อีกครั้ง");
                                //$("#btn_click").trigger("click");
                                // $('#myModal').modal({ backdrop: 'static', keyboard: false }, 'show');
                                $("#myModal").modal();
                                return false;
                                //window.location.replace("../Account/LogIn");
                            }
                        }
                    }
                });
            }

            function urllogin() {
                window.location.replace(lastname + "/Account/LogIn");
            }
            $(document).on("click", "#myModal", function () {

                // $('#myModal3').click(function () {
                if (usertype == "14") {
                    $("#myModal").modal({ backdrop: "static" });
                }
            });
            $('#btnlogin').click(function () {
                //if (usertype == "14") {
               // alert(lastname)
                window.location.replace(lastname + "/Account/LogIn");
                //}
            });

            if (usertype == "14") {
                $(window).on('load', function () {
                    //alert("load")
                    checklogin(userid, id)
                });
                window.onclick = function () {
                    //alert("onclick")
                    checklogin(userid, id)
                };
                $('.navbar-nav').click(function () {
                    // alert("navbar-nav")
                    checklogin(userid, id)

                });
                $('a').click(function () {
                    //  alert("a")
                    checklogin(userid, id)

                });
                //$(document).bind('keypress.session', function (ed, e) {
                //    checklogin(userid, id)
                //});
                $(document).bind('mousedown keydown', function (ed, e) {

                    checklogin(userid, id)
                });
                $(window).scroll(function (e) {

                    checklogin(userid, id)
                });

            }

            function check() {

                var input = $('#confirm_password').val()
                if (input.value != $('#confirm_password1').val()) {
                    input.setCustomValidity('Password Must be Matching.');

                } else {
                    // input is valid -- reset the error message
                    input.setCustomValidity('');

                }
            }
            function CvalidatePassword() {

                var password = document.getElementById("confirm_password")
                   , confirm_password = document.getElementById("confirm_password1");

                function validatePassword() {
                    if (password.value != confirm_password.value) {
                        confirm_password.setCustomValidity("Passwords Don't Match");
                    } else {
                        confirm_password.setCustomValidity('');
                    }
                }

                password.onchange = validatePassword;
                confirm_password.onkeyup = validatePassword;
            }

            $(".toggle-password").click(function () {

                $(this).toggleClass("fa-eye fa-eye-slash");
                var input = $($(this).attr("toggle"));
                if (input.attr("type") == "password") {
                    input.attr("type", "text");
                } else {
                    input.attr("type", "password");
                }
            });
            $(".toggle-cfpassword").click(function () {

                $(this).toggleClass("fa-eye fa-eye-slash");
                var input = $($(this).attr("toggle"));
                if (input.attr("type") == "password") {
                    input.attr("type", "text");
                } else {
                    input.attr("type", "password");
                }
            });
            $(".toggle-cfpassword1").click(function () {

                $(this).toggleClass("fa-eye fa-eye-slash");
                var input = $($(this).attr("toggle"));
                if (input.attr("type") == "password") {
                    input.attr("type", "text");
                } else {
                    input.attr("type", "password");
                }
            });
            var myInputcf = document.getElementById("confirm_password");
            var lettercf = document.getElementById("letter");
            var capitalcf = document.getElementById("capital");
            var numbercf = document.getElementById("number");
            var lengthcf = document.getElementById("length");
            // When the user clicks on the password field, show the message box
            myInputcf.onfocus = function () {
                document.getElementById("message").style.display = "block";
            }

            // When the user clicks outside of the password field, hide the message box
            myInputcf.onblur = function () {
                document.getElementById("message").style.display = "none";
            }

            // When the user starts to type something inside the password field
            myInputcf.onkeyup = function () {
                // Validate lowercase letters
                var lowerCaseLetters = /[a-z]/g;
                if (myInputcf.value.match(lowerCaseLetters)) {
                    lettercf.classList.remove("invalid");
                    lettercf.classList.add("valid");
                } else {
                    lettercf.classList.remove("valid");
                    lettercf.classList.add("invalid");
                }

                // Validate capital letters
                var upperCaseLetters = /[A-Z]/g;
                if (myInputcf.value.match(upperCaseLetters)) {
                    capitalcf.classList.remove("invalid");
                    capitalcf.classList.add("valid");
                } else {
                    capitalcf.classList.remove("valid");
                    capitalcf.classList.add("invalid");
                }

                // Validate numbers
                var numbers = /[0-9]/g;
                if (myInputcf.value.match(numbers)) {
                    numbercf.classList.remove("invalid");
                    numbercf.classList.add("valid");
                } else {
                    numbercf.classList.remove("valid");
                    numbercf.classList.add("invalid");
                }

                // Validate length
                if (myInputcf.value.length >= 8) {
                    lengthcf.classList.remove("invalid");
                    lengthcf.classList.add("valid");
                } else {
                    lengthcf.classList.remove("valid");
                    lengthcf.classList.add("invalid");
                }
            }



            //ยืนยัน///
            var myInputcf1 = document.getElementById("confirm_password1");
            var lettercf1 = document.getElementById("letter1");
            var capitalcf1 = document.getElementById("capital1");
            var numbercf1 = document.getElementById("number1");
            var lengthcf1 = document.getElementById("length1");
            // When the user clicks on the password field, show the message box
            myInputcf1.onfocus = function () {
                document.getElementById("message1").style.display = "block";
            }

            // When the user clicks outside of the password field, hide the message box
            myInputcf1.onblur = function () {
                document.getElementById("message1").style.display = "none";
            }

            // When the user starts to type something inside the password field
            myInputcf1.onkeyup = function () {
                // Validate lowercase letters
                var lowerCaseLetters = /[a-z]/g;
                if (myInputcf1.value.match(lowerCaseLetters)) {
                    lettercf1.classList.remove("invalid");
                    lettercf1.classList.add("valid");
                } else {
                    lettercf1.classList.remove("valid");
                    lettercf1.classList.add("invalid");
                }

                // Validate capital letters
                var upperCaseLetters = /[A-Z]/g;
                if (myInputcf1.value.match(upperCaseLetters)) {
                    capitalcf1.classList.remove("invalid");
                    capitalcf1.classList.add("valid");
                } else {
                    capitalcf1.classList.remove("valid");
                    capitalcf1.classList.add("invalid");
                }

                // Validate numbers
                var numbers = /[0-9]/g;
                if (myInputcf1.value.match(numbers)) {
                    numbercf1.classList.remove("invalid");
                    numbercf1.classList.add("valid");
                } else {
                    numbercf1.classList.remove("valid");
                    numbercf1.classList.add("invalid");
                }

                // Validate length
                if (myInputcf1.value.length >= 8) {
                    lengthcf1.classList.remove("invalid");
                    lengthcf1.classList.add("valid");
                } else {
                    lengthcf1.classList.remove("valid");
                    lengthcf1.classList.add("invalid");
                }
            }
            //////



            $().ready(function () {
                // validate the comment form when it is submitted
                $("#commentForm").validate();

                // validate signup form on keyup and submit
                $("#signupForm").validate({
                    rules: {
                        b_name: "required",
                        b_lastname: "required",
                        username: {
                            required: true,
                            minlength: 2
                        },
                        //password: {
                        //    required: true,
                        //    minlength: 5
                        //},
                        confirm_password1: {
                            required: false,
                            minlength: 5,
                            equalTo: "#confirm_password"
                        },
                        //email: {
                        //    required: true,
                        //    email: true
                        //},
                        topic: {
                            required: "#newsletter:checked",
                            minlength: 2
                        },
                        agree: "required",
                        address1: "required",
                        // address2: "required",
                        district: "required",
                        amphoe: "required",
                        province: "required",
                        zipcode: "required",
                        b_tel: "required",
                        //b_lineid: "required",
                    },
                    messages: {
                        b_name: "กรุณากรอกชื่อของท่าน",
                        b_lastname: "กรุณากรอกนามสกุลของท่าน",
                        username: {
                            required: "Please enter a username",
                            minlength: "Your username must consist of at least 2 characters"
                        },
                        //password: {
                        //    required: "กรุณาใส่ รหัสผ่าน",
                        //    minlength: "Your password must be at least 8 characters long"
                        //},
                        //confirm_password: {
                        //    required: "กรุณาใส่ ยืนยันรหัสผ่าน",
                        //    minlength: "Your password must be at least 8 characters long",
                        //    equalTo: "กรุณา ยืนยันรหัสผ่านใหม่ รหัสผ่านไม่ตรงกัน"
                        //},
                        //email: "กรุณากรอกอีเมล",
                        address1: "กรุณากรอก ที่อยู่ของท่าน",
                        // address2: "กรุณาใส่ ที่อยู่ของท่าน",
                        district: "กรุณากรอก แขวง/ตำบล ของท่าน",
                        amphoe: "กรุณากรอก เขต/อำเภอ ของท่าน",
                        province: "กรุณากรอก จังหวัด ของท่าน",
                        zipcode: "กรุณาใกรอก รหัสไปรษณีย์ ของท่าน",
                        b_tel: "กรุณากรอก เบอร์โทรศัพท์ ของท่าน"
                        // b_lineid: "กรุณาใส่ Line ID ของท่าน"
                        // agree: "Please accept our policy",
                        // topic: "Please select at least 2 topics"
                    }
                });

                // propose username by combining first- and lastname
                $("#username").focus(function () {
                    var firstname = $("#firstname").val();
                    var lastname = $("#lastname").val();
                    if (firstname && lastname && !this.value) {
                        this.value = firstname + "." + lastname;
                    }
                });

                //code to hide topic selection, disable for demo
                var newsletter = $("#newsletter");
                // newsletter topics are optional, hide at first
                var inital = newsletter.is(":checked");
                var topics = $("#newsletter_topics")[inital ? "removeClass" : "addClass"]("gray");
                var topicInputs = topics.find("input").attr("disabled", !inital);
                // show when newsletter is checked
                newsletter.click(function () {
                    topics[this.checked ? "removeClass" : "addClass"]("gray");
                    topicInputs.attr("disabled", !this.checked);
                });
            });
            $.validator.setDefaults({
                submitHandler: function () {
                    // alert("submitted!");
                    var b_name = $('#b_name').val();
                    var b_lastname = $('#b_lastname').val();
                    //var b_password = $('#password').val();
                    // var b_cfpassword = $('#confirm_password').val();
                    var b_address1 = $('#address1').val();
                    var b_address2 = $('#address2').val();
                    var b_district = $('#district').val();
                    var b_amphoe = $('#amphoe').val();
                    var b_province = $('#province').val();
                    var b_zipcode = $('#zipcode').val();
                    var b_tel = $('#b-tel').val();
                    var b_lineid = $('#b_lineid').val();
                    var b_email = $('#email').val();
                    var b_cfpassword = $('#confirm_password1').val();
                    var pw = document.getElementById("confirm_password1").value;
                    var getPasswordOld = $("#getPasswordOld").val().replace(/\s+/g, '');
                    var inputPasswordOld = $("#password").val().replace(/\s+/g, '');

                    if (b_lineid == "" && b_email == "") {
                        alert("กรุณาใส่ไลน์ไอดีหรือ อีเมลของท่านในการลงทะเบียน"); return false;

                    }

                    if (pw != "") {
                        if (/[0-9]/.test(pw) && /[a-z]/.test(pw) && /[A-Z]/.test(pw)) {
                            //document.getElementById("messagex").innerHTML = "**รหัสของคุณผ่านปลอดภัย";
                        }
                        else { document.getElementById("messagex").innerHTML = "**รหัสผ่านใหม่ของคุณไม่ปลอดภัย"; return false; }

                        //minimum password length validation
                        if (pw.length < 8) {
                            document.getElementById("messagex").innerHTML = "**รหัสผ่านของคุณต้องมีความยาว 8 ตัวอักษร";
                            return false;
                        }
                    }
                    //var checkpassword = $('#messageMatching').text();
                    //if (checkpassword == "Password Not Matching") { alert("กรุณายืนยันรหัสผ่านให้ตรงกับรหัสผ่านของท่าน"); return false; }

                    // if (b_password != b_cfpassword) {
                    //    alert("กรุณายืนยันรหัสผ่านให้ตรงกับรหัสผ่าน"); return false;
                    // }
                    // checkpassword();
                    // checkcfpassword();
                    // $('#confirm_password').trigger('click');
                    //$("#overlay").fadeIn(300);
                    //check chang password
                    if (inputPasswordOld != "") {
                        if (inputPasswordOld != getPasswordOld) { //ตรงกับรหัสผ่านเก่า
                            alert("ท่านกรอกรหัสผ่านปัจจุบันไม่ถูกต้อง กรุณากรอกใหม่อีกครั้ง");
                            return false;
                        }
                    }
                        $.ajax({
                        url: '@Url.Action("EditRegister", "EditWarrantyregister")',
                        data: {
                            b_name: $('#b_name').val(),
                            b_lastname: $('#b_lastname').val(),
                            // b_password: $('#password').val(),
                            //  b_cfpassword: $('#confirm_password').val(),
                            b_address1: $('#address1').val(),
                            b_address2: $('#address2').val(),
                            b_district: $('#district').val(),
                            b_amphoe: $('#amphoe').val(),
                            b_province: $('#province').val(),
                            b_zipcode: $('#zipcode').val(),
                            b_tel: $('#b_tel').val(),
                            b_lineid: $('#b_lineid').val(),
                            b_email: $('#email').val(),
                        },
                        type: "POST",
                        dataType: "JSON",
                        success: function (data) {
                            // alert(data.message)
                            // $("#meassagetext").html(data.message);
                            if (data.message == "Y") {
                                if (b_cfpassword != "") {
                                    $.ajax({
                                        url: '@Url.Action("savechangepassword", "Account")',
                                        data: {
                                            b_name: userid,
                                            b_cfpassword: $('#confirm_password1').val(),
                                        },
                                        type: "POST",
                                        dataType: "JSON",
                                        success: function (data) {
                                            // alert(data.message)
                                            // $("#meassagetext").html(data.message);
                                            if (data.message == "Y") {
                                                $("#hiddenclick").trigger("click");
                                            } else {
                                                alert(data.message);
                                                return false;
                                                //$("#meassagetext").html("Password is correct")
                                                // $("#meassagetext").removeClass('weak-password');
                                                // $("#meassagetext").addClass('strong-password');
                                                // $('#savepas').removeAttr("disabled");
                                            }
                                        }
                                    }).done(function () {
                                        setTimeout(function () {
                                            $("#overlay").fadeOut(100);
                                        }, 500);
                                    });
                                } else {
                                    $("#overlay").fadeOut(100);
                                    alert("แก้ไขข้อมูลสำเร็จ");
                                    var wi = window.open(lastname + "/Inquiry/Index");
                                    wi.focus();
                                }
                                //$("#meassagetext").html("Invalid password")
                                // $("#meassagetext").addClass('weak-password');
                                // $("#meassagetext").removeClass('strong-password');
                                // $('#savepas').prop("disabled", true);
                            } else {
                                alert(data.message);
                                return false;
                                //$("#meassagetext").html("Password is correct")
                                // $("#meassagetext").removeClass('weak-password');
                                // $("#meassagetext").addClass('strong-password');
                                // $('#savepas').removeAttr("disabled");
                            }
                        }
                    }).done(function () {
                        setTimeout(function () {
                            $("#overlay").fadeOut(300);
                        }, 500);
                    });
                }
            });
            $("#b_lineid").keypress(function (event) {
                var ew = event.which;
                if (ew == 32)
                    return true;
                if (48 <= ew && ew <= 57)
                    return true;
                if (65 <= ew && ew <= 90)
                    return true;
                if (97 <= ew && ew <= 122)
                    return true;
                return false;
            });
            $(document).on("click", "#confirm_password", function () {

                $('#messagex').text("");

            });
            $(document).on("click", "#myModal", function () {

                // $('#myModal3').click(function () {
                if (usertype == "14") {
                    $("#myModal").modal({ backdrop: "static" });
                }
            });

    </script>
</body>
</html>





